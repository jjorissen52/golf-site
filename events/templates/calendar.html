{% extends 'base.html' %}
{% load static %}
{% block meta_title %}Upcoming Events{% endblock %}
{% block title %}<h3>Upcoming Events</h3>{% endblock %}
{% block calendar %}
<head>
{#    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.6.2/fullcalendar.min.js"></script>#}
{#    <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.6.2/fullcalendar.min.css" rel='stylesheet' />#}
    <script src="{% static "js/jquery.min.js" %}"></script>
    <script src="{% static "js/moment.min.js" %}"></script>
    <script src="{% static "js/fullcalendar.min.js" %}"></script>
    <link href="{% static "js/fullcalendar.min.css" %}" rel='stylesheet' />
    <link href="{% static "js/fullcalendar.print.min.css" %}" rel='stylesheet' media='print' />
{#    <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.6.2/fullcalendar.print.css" rel='stylesheet' media='print' />#}
</head>
<div id="event-info" class="alert alert-info">
  <strong>Click or Hover over an event to see details.</strong>
</div>
<div id="calendar"></div>

<div id='loading'>loading...</div>

<div id='script-warning'>
    endpoint <code>api/upcoming-events</code> could not be found. If the issue persists contact your system adminstrator.
</div>

<script>
	$(document).ready(function() {

		$('#calendar').fullCalendar({
			header: {
				left: 'prev,next today',
				center: 'title',
				right: 'month,listWeek'
			},
			defaultDate: moment.now(),
			editable: true,
			navLinks: true, // can click day/week names to navigate views
			eventLimit: true, // allow "more" link when too many events
			events: {
				url: '{% url "event-list" %}',
				error: function() {
					$('#script-warning').show();
				},
                success: function() {
				    $('#event-info').html('<strong>Click or Hover over an event to see details.</strong>');
				}
			},
            eventRender: function(event, element) {
                element.attr('title', event.description);
            },
			loading: function(bool) {
				$('#loading').toggle(bool);
			},
            eventClick: function(calEvent, jsEvent, view) {
{#                alert('Event: ' + calEvent.description);#}
                calEvent.description ? $('#event-info').text(calEvent.description) : $('#event-info').html('<strong>Click or Hover over an event to see details.</strong>');
            }
		});

	});
</script>
<style>

	body {
		margin: 0;
		padding: 0;
		font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
		font-size: 14px;
	}

	#script-warning {
		display: none;
		background: #eee;
		border-bottom: 1px solid #ddd;
		padding: 0 10px;
		line-height: 40px;
		text-align: center;
		font-weight: bold;
		font-size: 12px;
		color: red;
	}

	#loading {
		display: none;
		position: absolute;
		top: 10px;
		right: 10px;
	}

</style>
{% endblock calendar %}